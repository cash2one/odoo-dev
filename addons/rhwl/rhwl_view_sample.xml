<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <record model="ir.ui.view" id="sale_sample_tree">
            <field name="name">sale.sample.tree</field>
            <field name="model">sale.sampleone</field>
            <field name="arch" type="xml">
                <tree string="Sample Information">
                    <field name="name"/>
                    <field name="yfxm"/>
                    <field name="yfage"/>
                    <field name="yflastyj"/>
                    <field name="yfyzweek"/>
                    <field name="yfzjmc_no"/>
                    <field name="cx_date"/>
                    <field name="check_state"/>
                    <field name="state_id"/>
                    <field name="city_id"/>
                    <field name="cxyy"/>
                    <field name="cxys"/>
                    <field name="is_reused"/>
                    <field name="is_free"/>
                    <field name="state"/>
                    <button name="action_done"  states="draft" string="确认" type="object"
                                groups="rhwl.rhwl_manager_sample" icon="gtk-apply" />
                    <button name="action_cancel" states="draft" string="取消" type="object"
                            groups="rhwl.rhwl_manager_sample" icon="gtk-cancel"/>
                </tree>
            </field>
        </record>
        <record model="ir.ui.view" id="sale_sample_reuse_tree">
            <field name="name">Again Blood</field>
            <field name="model">sale.sampleone.reuse</field>
            <field name="arch" type="xml">
                <tree string="Sale Sampleone">
                    <field name="name"/>
                    <field name="yfxm"/>
                    <field name="cx_date"/>
                    <field name="yfage"/>
                    <field name="yfyzweek"/>
                    <field name="yftelno"/>
                    <field name="cxys"/>
                    <field name="notice_user"/>
                    <field name="notice_date"/>
                    <field name="reuse_note"/>
                    <field name="newname"/>
                    <field name="note"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>
        <record model="ir.ui.view" id="sale_sample_exception_tree">
            <field name="name">sale.sample.exception.tree</field>
            <field name="model">sale.sampleone.exception</field>
            <field name="arch" type="xml">
                <tree string="Sale Sampleone">
                    <field name="name"/>
                    <field name="yfxm"/>
                    <field name="cx_date"/>
                    <field name="yfage"/>
                    <field name="yfyzweek"/>
                    <field name="yftelno"/>
                    <field name="cxys"/>
                    <field name="lib_notice"/>
                    <field name="cs_notice"/>
                    <field name="notice_user"/>
                    <field name="notice_date"/>
                    <field name="fz_user"/>
                    <field name="is_notice"/>
                    <field name="is_take"/>
                    <field name="is_next"/>
                    <field name="next_date"/>
                    <field name="next_hospital"/>
                    <field name="next_result"/>
                    <field name="is_equal"/>
                </tree>
            </field>
        </record>
        <record model="ir.ui.view" id="sale_sample_form">
            <field name="name">sale.sample.form</field>
            <field name="model">sale.sampleone</field>
            <field name="arch" type="xml">
                <form string="Sale Sample">
                    <header>
                        <button name="action_done"  states="draft" string="确认" type="object"
                                groups="rhwl.rhwl_manager_sample" class="oe_highlight oe_read_only"/>
                        <button name="action_cancel" states="draft" string="取消" type="object" class="oe_read_only"
                                groups="rhwl.rhwl_manager_sample"/>
                        <button name="action_cancel2draft" states="cancel" string="重新转为草稿" type="object"
                                groups="base.group_user" class="oe_highlight"/>
                        <button name="action_get_library" states="done" string="接收实验室结果" type="object"
                                groups="base.group_user"/>
                        <button name="action_check_ok" string="检验结果正常" type="object" attrs="{'invisible':[('check_state','not in',('library','pc','get'))]}"
                                groups="base.group_user"/>
                        <button name="action_check_reused"  string="需重采血" type="object" attrs="{'invisible':[('check_state','not in',('library','pc','get'))]}"
                                groups="base.group_user" class="oe_highlight"/>
                        <button name="action_check_except"  string="检验结果阳性" type="object" attrs="{'invisible':[('check_state','not in',('library','pc','get'))]}"
                                groups="base.group_user" class="oe_highlight"/>
                        <button name="action_sms" string="短信通知" type="object" attrs="{'invisible':[('check_state','not in',('ok','reuse','except'))]}"
                                groups="base.group_user"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,done,cancel"
                               statusbar_colors='{"cancel":"red","done":"blue"}' readonly="1"/>
                    </header>
                    <sheet >
                        <group>
                            <group>
                                <field name="name" on_change="onchange_check_sample(name)" attrs="{'readonly':['|',('state','=','done'),('state','=','checkok')]}"/>
                                <field name="sampletype"/>
                                <label for="cx_date" string="采血日期"/>
                                <div class="address_format">
                                    <field name="cx_date" style="width: 50%"/>
                                    <label for="cx_time" string="时间" class="oe_form_field" style="width: 20%"/>
                                    <field name="cx_time" style="width: 30%"/>
                                </div>
                                <field name="is_reused" on_change="onchange_reused(is_reused,sampletype)" attrs="{'readonly':['|',('state','=','done'),('state','=','checkok')]}"/>
                                <field name="reuse_type"
                                       attrs="{'required':[('is_reused','=','1')],'invisible':[('is_reused','&lt;&gt;','1')]}"/>
                                <field name="reuse_name" on_change="onchange_reuse_name(reuse_name)"
                                       attrs="{'required':[('is_reused','=','1')],'invisible':[('is_reused','&lt;&gt;','1')],'readonly':['|',('state','=','done'),('state','=','checkok')]}"/>
                                <field name="is_free" colspan='2' attrs="{'readonly':['|',('state','=','done'),('state','=','checkok')]}"/>
                                <field name="urgency"/>
                            </group>
                            <group>
                                <field name="receiv_user"/>
                                <field name="state_id"/>
                                <field name="city_id"/>
                                <field name="lyyy" on_change="onchange_lyyy()"/>
                                <field name="lyys" on_change="onchange_ys(lyyy,cxyy,lyys,'cxys')"/>
                                <field name="cxyy" on_change="onchange_cxyy(lyyy,cxyy)" attrs="{'readonly':['|',('state','=','done'),('state','=','checkok')]}"/>
                                <field name="cxys" on_change="onchange_ys(lyyy,cxyy,cxys,'lyys')" attrs="{'readonly':['|',('state','=','done'),('state','=','checkok')]}"/>
                                <field name="fzr"/>
                                <field name="hospital_seq"/>
                            </group>
                        </group>

                        <notebook>
                            <page string="孕妇信息">
                                <group col="8" string="孕妇填写">
                                    <group>
                                        <field name="yfxm"/>
                                        <field name="yfheight"/>
                                        <field name="yftelno"/>
                                        <field name="yfpostaddr"/>

                                        <label for="yfzjmc" string="证件名称"/>
                                        <div>
                                            <field name="yfzjmc" width="90"/>
                                            <field name="yfzjmc_no" placeholder="请输入证件号码"
                                                   on_change="onchange_zjmcno(yfzjmc_no,yfzjmc)"/>
                                        </div>


                                    </group>
                                    <group>
                                        <field name="yfage"/>

                                        <field name="yfweight"/>

                                        <field name="yfjjlltel"/>

                                        <field name="yfpostno"/>
                                    </group>
                                </group>
                                <group col="18" string="医生填写">

                                         <group colspan="5">
                                             <field name="yflastyj"/>
                                        </group>
                                        <group  colspan="5">
                                            <field name="yfyjzqtext"/>
                                        </group>
                                        <group colspan="8">
                                            <label for="yfyzweek" string="孕周"/>
                                            <div class="address_format">
                                                <field name="yfyzweek" class="oe_align_right oe_inline"
                                                       style="width: 10%%"/>
                                                <label string="周" style="width: 10%%" class="oe_form_field"/>
                                                <field name="yfyzday" class="oe_align_right oe_inline" style="width: 10%%"/>
                                                <label string="天" style="width: 10%%" class="oe_form_field"/>
                                            </div>
                                        </group>

                                        <group colspan="18">
                                            <label for="yfyczk" string="B超结果"/>
                                            <div>
                                                <field name="yfyczk" style="width:10%%"/>
                                                <field name="yfyczktext"  style="width:40%%" placeholder="其它说明"
                                                       attrs="{'invisible':[('yfyczk','!=','3')]}"/>
                                            </div>
                                            <label for="yfissgyr" string="妊娠方式"/>
                                            <div>
                                                <field name="yfissgyr" style="width:20%%"/>
                                                 <field name="yfissgyrdate" style="width:40%%" placeholder="移植日期" attrs="{'invisible':[('yfissgyr','!=','1')]}"/>
                                            </div>
                                            <label for="yfxqsc" string="唐筛结果"/>
                                            <div>
                                                <field name="yfxqsc" style="width:20%%"/>
                                                <div attrs="{'invisible':[('yfxqsc','!=','1')]}">
                                                    <div>
                                                        <label string="早筛："/>
                                                        <field name="yfxqscfx" style="width:15%%"/>
                                                        <label for="yfxqscsel" string="21-三体:1/" />
                                                        <field name="yfxqscsel" style="width: 15%" />
                                                        <label for="yfxqscsel1" string="18-三体:1/" />
                                                        <field name="yfxqscsel1"  style="width: 15%"/>
                                                        <label for="yfxqscsel2" string="13-三体:1/"/>
                                                        <field name="yfxqscsel2"  style="width: 15%"/>
                                                    </div>
                                                    <div>
                                                        <label string="中筛："/>
                                                        <field name="yfxqscfx_m" style="width:15%%"/>
                                                        <label for="yfxqscsel_m" string="21-三体:1/" />
                                                        <field name="yfxqscsel_m" style="width: 15%" />
                                                        <label for="yfxqscsel1_m" string="18-三体:1/" />
                                                        <field name="yfxqscsel1_m"  style="width: 15%"/>
                                                        <label for="yfxqscsel2_m" string="13-三体:1/"/>
                                                        <field name="yfxqscsel2_m"  style="width: 15%"/>

                                                    </div>
                                                    <label string="其它："/>
                                                    <field name="yfxqscfxother" style="width:80%%"/>
                                                </div>
                                            </div>
                                            <label for="yfycount" string="孕产史"/>
                                            <div>
                                                <label string="孕次数"/>
                                                <field name="yfycount" style="width: 15%"/>
                                                <label string="产次数"/>
                                                <field name="yfzcount" style="width: 15%"/>
                                                <label string="人流次数"/>
                                                <field name="yfrlcount" style="width: 15%"/>
                                                <label string="自然流产次数"/>
                                                <field name="yfzrlccount" style="width: 15%"/>
                                                <div>
                                                    <label string="不良孕产史"/>
                                                    <field name="yfblycstext" style="width:80%"/>
                                                </div>
                                            </div>
                                            <label for="yfynnytsx" string="既往史"/>
                                            <div>
                                                <div class="oe_inline">

                                                        <label for="yfynnytsx" string="输入异体血制品"/>
                                                         <field name="yfynnytsx" placeholder=" " style="width:20%%"/>

                                                         <label for="yfzlfz" string="移植手术"/>
                                                        <field name="yfzlfz" placeholder=" " style="width:20%%" />

                                                         <label for="yfxbzl" string="干细胞治疗"/>
                                                          <field name="yfxbzl" placeholder=" " style="width:20%%" />
                                                </div>

                                                <div>
                                                    <label string="日期"/>
                                                    <field name="yfjwsdate" style="width:20%"/>
                                                </div>
                                            </div>
                                            <field name="yfynnytsxtext"/>
                                            <field name="yfjzycbtext"/>
                                            <label for="yffqsfrsthx" string="夫妻双方染色体检查"/>
                                            <div>
                                                <field name="yffqsfrsthx" style="width:20%"/>
                                                <field name="yffqsfrsthxtext" placeholder="夫妻双方染色体核型说明"
                                                       attrs="{'invisible':[('yffqsfrsthx','!=','1')]}" style="width:60%"/>
                                            </div>
                                            <field name="yftsqkbz"/>
                                        </group>
                                </group>
                            </page>
                            <page string="实验历程">
                                <field name="lims">
                                    <tree>
                                        <field name="timestr"/>
                                        <field name="stat"/>
                                        <field name="note"/>
                                    </tree>
                                 </field>
                            </page>
                            <page string="备注">
                                <field name="note"/>
                            </page>
                        </notebook>

                    </sheet>
                     <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                    <footer>
                        <field name="check_state" widget="statusbar"
                               statusbar_colors='{"需重采血":"red","检验结果阳性":"red","检验结果正常":"blue"}' readonly="1"/>
                    </footer>
                </form>
            </field>
        </record>

        <record model="ir.ui.view" id="sale_sample_reuse_form">
            <field name="name">sale.sample.reuse.form</field>
            <field name="model">sale.sampleone.reuse</field>
            <field name="arch" type="xml">
                <form string="Sale Sample">
                    <header>
                        <button name="action_done" states="draft" string="已通知" type="object"
                                groups="base.group_user" class="oe_highlight"/>
                        <button name="action_cancel" states="done" string="孕妇放弃" type="object"
                                groups="base.group_user" class="oe_highlight"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,done,cancel"
                               statusbar_colors='{"cancel":"red","done":"blue"}' readonly="1"/>
                    </header>
                    <sheet>
                        <group>
                            <group>
                                <field name="name" attrs="{'readonly':True}"/>
                                <field name="yfxm"/>
                                <field name="cx_date"/>
                                <field name="yfage"/>
                                <field name="yfyzweek"/>
                                <field name="newname"/>
                            </group>
                            <group>
                                <field name="yftelno"/>
                                <field name="cxys"/>
                                <field name="notice_user"/>
                                <field name="notice_date"/>
                                <field name="reuse_note"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="孕妇说明及备注">
                                <field name="note"/>
                            </page>

                        </notebook>
                    </sheet>

                </form>
            </field>
        </record>

        <record model="ir.ui.view" id="sale_sample_exception_form">
            <field name="name">sale.sample.exception.form</field>
            <field name="model">sale.sampleone.exception</field>
            <field name="arch" type="xml">
                <form string="Sale Sample">
                    <header>
                        <button name="action_notice" states="draft" string="已通知" type="object"
                                groups="base.group_user" class="oe_highlight"/>
                        <button name="action_report" states="notice,renotice" string="已取报告" type="object"
                                groups="base.group_user" class="oe_highlight"/>
                        <button name="action_next" states="getreport" string="已进一步诊断" type="object"
                                groups="base.group_user" class="oe_highlight"/>
                        <button name="action_done" states="next" string="完成" type="object"
                                groups="base.group_user" class="oe_highlight"/>
                        <button name="action_cancel" states="draft,notice,getreport,next" string="中止" type="object"
                                groups="base.group_user" class="oe_highlight"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,notice,getreport,next,done,cancel"
                               statusbar_colors='{"cancel":"red","done":"blue"}' readonly="1"/>
                    </header>
                    <sheet>
                        <group>
                            <group>
                                <field name="name" attrs="{'readonly':True}"/>
                                <field name="yfxm"/>
                                <field name="cx_date"/>
                                <field name="yfage"/>
                                <field name="yfyzweek"/>
                                <field name="yftelno"/>
                                <field name="cxys"/>
                                <field name="lib_notice"/>
                                <field name="cs_notice"/>
                                <field name="notice_user"/>
                                <field name="notice_date"/>
                            </group>
                            <group>
                                <field name="fz_user"/>
                                <field name="is_notice"/>
                                <field name="is_take"/>
                                <field name="is_next"/>
                                <field name="next_date"/>
                                <field name="next_hospital"/>
                                <field name="next_result"/>
                                <field name="is_equal"/>
                            </group>

                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record model="ir.ui.view" id="sale_sample_search">
            <field name="name">sale.sample.search</field>
            <field name="model">sale.sampleone</field>
            <field name="arch" type="xml">
                <search string="Sale Sample">
                    <field name="name"/>
                    <field name="yfxm"/>
                    <field name="cxyy" filter_domain="[('cxyy', 'ilike', self)]" string="采血医院"/>
                    <seperaotr/>
                    <filter string="首次采血" name="type_reuse1" domain="[('is_reused','=','0')]"/>
                    <filter string="重采血" name="type_reuse2" domain="[('is_reused','=','1')]"/>
                    <filter string="最近一周采血" name="type_reuse5" domain="[('cx_date','&gt;=',(context_today()+datetime.timedelta(days=-6)).strftime('%%Y-%%m-%%d'))]"/>
                    <separator/>
                    <filter string="免费" name="type_reuse3" domain="[('is_free','=','1')]"/>
                    <filter string="收费" name="type_reuse4" domain="[('is_free','=','0')]"/>
                    <separator/>
                    <filter string="已完成检测" name="type_done" domain="[('state','=','checkok')]"/>
                    <filter string="未完成检测" name="type_doing" domain="[('state','!=','checkok')]"/>
                    <group expand="0" string="分组">
                        <filter string="收样人员" icon="terp-partner" domain="[]" context="{'group_by':'receiv_user'}"/>
                        <filter string="样品区域(省)" icon="terp-partner" domain="[]" context="{'group_by':'state_id'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record model="ir.ui.view" id="sale_sample_reuse_search">
            <field name="name">sale.sample.reuse.search</field>
            <field name="model">sale.sampleone.reuse</field>
            <field name="arch" type="xml">
                <search string="Sale Sample">
                    <field name="name" string="Sample NO"/>
                    <field name="notice_user"/>
                    <seperaotr/>
                    <filter string="未通知" name="unnotice" domain="[('state','=','draft')]"/>
                    <filter string="已重采血" name="type_usered" domain="[('state','=','reuse')]"/>
                    <filter string="未重采血" name="type_notusered" domain="[('state','!=','reuse')]"/>
                    <group expand="0" string="Group By...">
                        <filter string="通知人员" icon="terp-partner" domain="[]"
                                context="{'group_by':'notice_user'}"/>
                        <filter string="采血医院" icon="terp-partner" domain="[]"
                                context="{'group_by':'cxyy'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record model="ir.ui.view" id="sale_sample_exception_search">
            <field name="name">sale.sample.exception.search</field>
            <field name="model">sale.sampleone.exception</field>
            <field name="arch" type="xml">
                <search string="Sale Sample">
                    <field name="name" string="Sample NO"/>
                    <field name="notice_user"/>
                    <seperaotr/>
                    <filter string="未通知" name="unnotice" domain="[('state','=','draft')]"/>
                    <group expand="0" string="Group By...">
                        <filter string="通知人员" icon="terp-partner" domain="[]"
                                context="{'group_by':'notice_user'}"/>
                        <filter string="采血医院" icon="terp-partner" domain="[]"
                                context="{'group_by':'cxyy'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record id="action_sale_sample" model="ir.actions.act_window">
            <field name="name">Sample Information</field>
            <field name="res_model">sale.sampleone</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                </p>
                <p>
                    Click to start creating a new
                </p>
            </field>
        </record>

        <record id="action_sale_sample_reuse" model="ir.actions.act_window">
            <field name="name">Again Blood</field>
            <field name="res_model">sale.sampleone.reuse</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'search_default_unnotice':1}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                </p>
                <p>
                    Click to start creating a new
                </p>
            </field>
        </record>
        <record id="action_sale_sample_exception" model="ir.actions.act_window">
            <field name="name">Excep Information</field>
            <field name="res_model">sale.sampleone.exception</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'search_default_unnotice':1}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                </p>
                <p>
                    Click to start creating a new
                </p>
            </field>
        </record>
        <menuitem id="menu_sale_sample" parent="base.menu_sales" name="Sample Information" sequence="10"
                  action='action_sale_sample' groups="base.group_sale_salesman,base.group_portal,rhwl_base_sample"/>
        <menuitem id="menu_sale_sample_reuse" parent="base.menu_sales" name="Again Blood" sequence="11"
                  action='action_sale_sample_reuse' groups="base.group_sale_salesman,rhwl_base_sample"/>
        <menuitem id="menu_sale_sample_exception" parent="base.menu_sales" name="Excep Information" sequence="12"
                  action='action_sale_sample_exception' groups="base.group_sale_salesman,rhwl_base_sample"/>

        <menuitem name="Sample Information" id="menu_sale_sample_portal" parent="portal.portal_orders"
            action="action_sale_sample" sequence="5"/>
         <menuitem id="menu_sale_sample_reuse_portal" parent="portal.portal_orders" name="Again Blood" sequence="6"
                  action='action_sale_sample_reuse' />
        <menuitem id="menu_sale_sample_exception_portal" parent="portal.portal_orders" name="Excep Information" sequence="7"
                  action='action_sale_sample_exception'/>

        <record id="mt_sample_cancel" model="mail.message.subtype">
            <field name="name">Sample Create</field>
            <field name="res_model">sale.sampleone</field>
            <field name="default" eval="False"/>
            <field name="description">Sample is Create</field>
        </record>
        <record id="mt_sample_done" model="mail.message.subtype">
            <field name="name">Sample Done</field>
            <field name="res_model">sale.sampleone</field>
            <field name="default" eval="False"/>
            <field name="description">样品确认</field>
        </record>
    </data>
</openerp>