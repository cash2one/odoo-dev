<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>MongoDB Edit</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="http://cdn.bootcss.com/bootstrap/3.3.2/css/bootstrap.min.css">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <ul class="nav nav-tabs" role="tablist" id="myTab">
      <li role="presentation" class="active"><a href="#cn" aria-controls="cn" role="tab" data-toggle="tab">中文</a></li>
      <li role="presentation"><a href="#en" aria-controls="profile" role="tab" data-toggle="tab">English</a></li>
    </ul>

    <div class="tab-content">
      <div role="tabpanel" class="tab-pane active" id="cn">
          <br>
          <div class="container-fluid">
              <div class="col-lg-1 col-md-2">
                  <label for="cn_title" class="control-label">疾病名称</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <input type="text" class="form-control" id="cn_title">
              </div>
              <hr/>

              <div class="col-lg-12 col-md-12">
                  <h2>疾病简介</h2>
              </div>
              <div class="col-lg-1 col-md-2" style="display:none">
                  <label for="cn_desc_header" class="control-label">标题</label>
              </div>
              <div class="col-lg-11 col-md-10" style="display:none">
                  <input type="text" class="form-control" id="cn_desc_header">
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="cn_desc_description" class="control-label">描述</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="cn_desc_description" rows="7"></textarea>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label class="control-label">图片</label>
              </div>
              <div class="col-lg-1 col-md-1">
                  <img id="cn_pic" width="100%" height="100%" src=""/>
              </div>
              <div class="col-lg-10 col-md-9">
                  <form id="cn_pic_form" enctype="multipart/form-data" action="/web/api/mongo/pic/post/" method="POST">
                        <input type="text" name="cn_data_id" id="cn_data_id" style="display:none"/>
                        <input type="file" name="choosefile" id="choosefile" />
                  </form>
              </div>

              <div class="col-lg-12 col-md-12">
                  <h2>遗传因素</h2>
              </div>
              <div class="col-lg-1 col-md-2" style="display:none">
                  <label for="cn_genetic_header" class="control-label">标题</label>
              </div>
              <div class="col-lg-11 col-md-10" style="display:none">
                  <input type="text" class="form-control" id="cn_genetic_header">
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="cn_genetic_description" class="control-label">描述</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="cn_genetic_description" rows="7"></textarea>
              </div>

              <div class="col-lg-12 col-md-12">
                  <h2>非遗传因素</h2>
              </div>
              <div class="col-lg-1 col-md-2" style="display:none">
                  <label for="cn_ngenetic_header" class="control-label">标题</label>
              </div>
              <div class="col-lg-11 col-md-10" style="display:none">
                  <input type="text" class="form-control" id="cn_ngenetic_header">
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="cn_ngenetic_description" class="control-label">描述</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="cn_ngenetic_description" rows="7"></textarea>
              </div>

              <div class="col-lg-12 col-md-12">
                  <h2>临床特征</h2>
              </div>
              <div class="col-lg-1 col-md-2" style="display:none">
                  <label for="cn_clinical_header" class="control-label">标题</label>
              </div>
              <div class="col-lg-11 col-md-10" style="display:none">
                  <input type="text" class="form-control" id="cn_clinical_header">
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="cn_clinical_description" class="control-label">描述</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="cn_clinical_description" rows="7"></textarea>
              </div>

              <div class="col-lg-12 col-md-12">
                  <h2>筛查与诊断</h2>
              </div>
              <div class="col-lg-1 col-md-2" style="display:none">
                  <label for="cn_diagnose_header" class="control-label">标题</label>
              </div>
              <div class="col-lg-11 col-md-10" style="display:none">
                  <input type="text" class="form-control" id="cn_diagnose_header">
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="cn_diagnose_description" class="control-label">描述</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="cn_diagnose_description" rows="7"></textarea>
              </div>

              <div class="col-lg-12 col-md-12" style="display:none">
                  <h2>报告结论</h2>
              </div>
              <div class="col-lg-1 col-md-2" style="display:none">
                  <label for="cn_report_header" class="control-label">标题</label>
              </div>
              <div class="col-lg-11 col-md-10" style="display:none">
                  <input type="text" class="form-control" id="cn_report_header">
              </div>
              <div class="col-lg-1 col-md-2" style="display:none">
                  <label for="cn_report_0" class="control-label">弱</label>
              </div>
              <div class="col-lg-11 col-md-10" style="display:none">
                  <textarea  class="form-control" id="cn_report_0" rows="1"></textarea>
              </div>
              <div class="col-lg-1 col-md-2" style="display:none">
                  <label for="cn_report_1" class="control-label">较弱</label>
              </div>
              <div class="col-lg-11 col-md-10" style="display:none">
                  <textarea  class="form-control" id="cn_report_1" rows="1"></textarea>
              </div>
              <div class="col-lg-1 col-md-2" style="display:none">
                  <label for="cn_report_2" class="control-label">平均水平</label>
              </div>
              <div class="col-lg-11 col-md-10" style="display:none">
                  <textarea  class="form-control" id="cn_report_2" rows="1"></textarea>
              </div>
              <div class="col-lg-1 col-md-2" style="display:none">
                  <label for="cn_report_3" class="control-label">较强</label>
              </div>
              <div class="col-lg-11 col-md-10" style="display:none">
                  <textarea  class="form-control" id="cn_report_3" rows="1"></textarea>
              </div>
              <div class="col-lg-1 col-md-2" style="display:none">
                  <label for="cn_report_4" class="control-label">强</label>
              </div>
              <div class="col-lg-11 col-md-10" style="display:none">
                  <textarea  class="form-control" id="cn_report_4" rows="1"></textarea>
              </div>


              <div class="col-lg-12 col-md-12">
                  <h2>预防建议</h2>
              </div>
              <div class="col-lg-1 col-md-2" style="display:none">
                  <label for="cn_suggestion_header" class="control-label">标题</label>
              </div>
              <div class="col-lg-11 col-md-10" style="display:none">
                  <input type="text" class="form-control" id="cn_suggestion_header">
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="cn_suggestion_description" class="control-label">描述</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="cn_suggestion_description" rows="7"></textarea>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="cn_suggestion_descriptionM" class="control-label">描述(男)</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="cn_suggestion_descriptionM" rows="7"></textarea>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="cn_suggestion_descriptionF" class="control-label">描述(女)</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="cn_suggestion_descriptionF" rows="7"></textarea>
              </div>

              <div class="col-lg-12 col-md-12">
                  <h2>营养保健</h2>
              </div>
              <div class="col-lg-1 col-md-2" style="display:none">
                  <label for="cn_nutrition_header" class="control-label">标题</label>
              </div>
              <div class="col-lg-11 col-md-10" style="display:none">
                  <input type="text" class="form-control" id="cn_nutrition_header">
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="cn_nutrition_description" class="control-label">描述</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="cn_nutrition_description" rows="7"></textarea>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="cn_nutrition_descriptionM" class="control-label">描述(男)</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="cn_nutrition_descriptionM" rows="7"></textarea>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="cn_nutrition_descriptionF" class="control-label">描述(女)</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="cn_nutrition_descriptionF" rows="7"></textarea>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label  class="control-label">饮食</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <table id="cn_nutrition_table" class="table">
                      <thead>
                        <th>名称</th>
                        <th>功能</th>
                        <th> </th>
                      </thead>
                      <tbody>

                      </tbody>
                  </table>
                  <button id="cn_nutrition_btn"class="btn btn-link">新增</button>
              </div>
          </div>
          <div>
              <button id="cn_submit" type="button" class="btn btn-primary text-center">提交中文修改</button>
          </div>
          <br>
      </div>
      <div role="tabpanel" class="tab-pane" id="en">
            		<br>
          <div class="container-fluid">
              <div class="col-lg-1 col-md-2">
                  <label for="en_title" class="control-label">Name</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <input type="text" class="form-control" id="en_title">
              </div>
              <hr/>

              <div class="col-lg-12 col-md-12">
                  <h2>Desc</h2>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_desc_header" class="control-label">Header</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <input type="text" class="form-control" id="en_desc_header">
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_desc_description" class="control-label">Description</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="en_desc_description" rows="4"></textarea>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label class="control-label">Image</label>
              </div>
              <div class="col-lg-1 col-md-1">
                  <img id="en_pic" width="100%" height="100%" src=""/>
              </div>
              <div class="col-lg-10 col-md-9">
                  <form id="en_pic_form" enctype="multipart/form-data" action="/web/api/mongo/pic/post/" method="POST">
                        <input type="text" name="en_data_id" id="en_data_id" style="display:none"/>
                        <input type="file" name="en_choosefile" id="en_choosefile" />
                  </form>
              </div>

              <div class="col-lg-12 col-md-12">
                  <h2>Genetic</h2>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_genetic_header" class="control-label">Header</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <input type="text" class="form-control" id="en_genetic_header">
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_genetic_description" class="control-label">Description</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="en_genetic_description" rows="7"></textarea>
              </div>

              <div class="col-lg-12 col-md-12">
                  <h2>Not Genetic</h2>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_ngenetic_header" class="control-label">Header</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <input type="text" class="form-control" id="en_ngenetic_header">
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_ngenetic_description" class="control-label">Description</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="en_ngenetic_description" rows="4"></textarea>
              </div>

              <div class="col-lg-12 col-md-12">
                  <h2>Clinical</h2>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_clinical_header" class="control-label">Header</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <input type="text" class="form-control" id="en_clinical_header">
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_clinical_description" class="control-label">Description</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="en_clinical_description" rows="7"></textarea>
              </div>

              <div class="col-lg-12 col-md-12">
                  <h2>Diagnose</h2>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_diagnose_header" class="control-label">Header</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <input type="text" class="form-control" id="en_diagnose_header">
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_diagnose_description" class="control-label">Description</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="en_diagnose_description" rows="7"></textarea>
              </div>

              <div class="col-lg-12 col-md-12">
                  <h2>Report</h2>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_report_header" class="control-label">Header</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <input type="text" class="form-control" id="en_report_header">
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_report_0" class="control-label">Level0</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="en_report_0" rows="1"></textarea>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_report_1" class="control-label">Level1</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="en_report_1" rows="1"></textarea>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_report_2" class="control-label">Level2</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="en_report_2" rows="1"></textarea>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_report_3" class="control-label">Level3</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="en_report_3" rows="1"></textarea>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_report_4" class="control-label">Level4</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="en_report_4" rows="1"></textarea>
              </div>


              <div class="col-lg-12 col-md-12">
                  <h2>Suggestion</h2>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_suggestion_header" class="control-label">Header</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <input type="text" class="form-control" id="en_suggestion_header">
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_suggestion_description" class="control-label">Description</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="en_suggestion_description" rows="7"></textarea>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_suggestion_descriptionM" class="control-label">Description(MALE)</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="en_suggestion_descriptionM" rows="7"></textarea>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_suggestion_descriptionF" class="control-label">Description(FEMALE)</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="en_suggestion_descriptionF" rows="7"></textarea>
              </div>

              <div class="col-lg-12 col-md-12">
                  <h2>Nutrition</h2>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_nutrition_header" class="control-label">Header</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <input type="text" class="form-control" id="en_nutrition_header">
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_nutrition_description" class="control-label">Description</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="en_nutrition_description" rows="7"></textarea>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_nutrition_descriptionM" class="control-label">Description(MALE)</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="en_nutrition_descriptionM" rows="7"></textarea>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label for="en_nutrition_descriptionF" class="control-label">Description(FEMALE)</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <textarea  class="form-control" id="en_nutrition_descriptionF" rows="7"></textarea>
              </div>
              <div class="col-lg-1 col-md-2">
                  <label  class="control-label">Compound</label>
              </div>
              <div class="col-lg-11 col-md-10">
                  <table id="en_nutrition_table" class="table">
                      <thead>
                        <th>Name</th>
                        <th>Function</th>
                        <th> </th>
                      </thead>
                      <tbody>

                      </tbody>
                  </table>
                  <button id="en_nutrition_btn"class="btn btn-link">Add...</button>
              </div>
          </div>
          <div>
              <button id="en_submit" type="button" class="btn btn-primary text-center">Submit</button>
          </div>
          <br>
      </div>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="http://cdn.bootcss.com/jquery/1.11.2/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="http://cdn.bootcss.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script src="js/jquery.form.js"></script>
    <script src="js/json2.js"></script>
    <script>
        function getUrlParameter(sParam)
        {
            var sPageURL = window.location.search.substring(1);
            var sURLVariables = sPageURL.split('&');
            for (var i = 0; i < sURLVariables.length; i++)
            {
                var sParameterName = sURLVariables[i].split('=');
                if (sParameterName[0] == sParam)
                {
                    return sParameterName[1];
                }
            }
        }
    </script>
    <script>
        $(document).ajaxStart(function(){
            $("<div id=\"wait_ajax\">数据加载中，请稍候......</div>").prependTo($("body"));
            });
        $(document).ajaxStop(function(){
            $("#wait_ajax").remove();
            });
        $("#cn_data_id").val(decodeURIComponent(getUrlParameter("id")));
        $("#cn_pic_form").ajaxForm();
        $("#cn_submit").bind("click",function(e){
            if($("#choosefile").val().length>0){$("#cn_pic_form").ajaxSubmit();}
            var para = {}
            para.CN={
                    title:$("#cn_title").val(),
                    desc:{
                            header:$("#cn_desc_header").val(),
                            description:$("#cn_desc_description").val()
                            },
                    genetic:{
                            header:$("#cn_genetic_header").val(),
                            description:$("#cn_genetic_description").val()
                            },
                    ngenetic:{
                            header:$("#cn_ngenetic_header").val(),
                            description:$("#cn_ngenetic_description").val()
                            },
                    clinical:{
                            header:$("#cn_clinical_header").val(),
                            description:$("#cn_clinical_description").val()
                            },
                    diagnose:{
                            header:$("#cn_diagnose_header").val(),
                            description:$("#cn_diagnose_description").val()
                            },
                    report:{
                            header:$("#cn_report_header").val(),
                            level0:$("#cn_report_0").val(),
                            level1:$("#cn_report_1").val(),
                            level2:$("#cn_report_2").val(),
                            level3:$("#cn_report_3").val(),
                            level4:$("#cn_report_4").val()
                            },
                    suggestion:{
                            header:$("#cn_suggestion_header").val(),
                            description:$("#cn_suggestion_description").val(),
                            descriptionM:$("#cn_suggestion_descriptionM").val(),
                            descriptionF:$("#cn_suggestion_descriptionF").val()
                             },
                    nutrition:{
                            header:$("#cn_nutrition_header").val(),
                            description:$("#cn_nutrition_description").val(),
                            descriptionM:$("#cn_nutrition_descriptionM").val(),
                            descriptionF:$("#cn_nutrition_descriptionF").val()
                             }
                    }
            para._id=decodeURIComponent(getUrlParameter("id"))
            para.CN.nutrition.compound=[]
            var compound=$("#cn_nutrition_table tbody").children();
            $.each(compound,function(k,v){
                para.CN.nutrition.compound[k]={
                                                    "name":compound[k].childNodes[0].childNodes[0].value,
                                                    "function":compound[k].childNodes[1].childNodes[0].value
                                                    }
            });
            $.ajax({
                type:"POST",
                contentType: "application/json; charset=utf-8",   //内容类型
                url:"/web/api/mongo/detail/post/",
                data:JSON.stringify(para),
                success:function(data){
                    alert("修改成功。");
                }

            })
        });
        $("#cn_nutrition_table tbody").bind("click",function(e){
           if(e.target.innerText=="删除"){
               $(e.target.parentElement.parentElement).remove();
           }
        });
        $("#cn_nutrition_btn").bind("click",function(e){
            $("#cn_nutrition_table tbody").append("<tr><td><input type=\"text\" class=\"form-control\" ></td><td><input type=\"text\" class=\"form-control\" ></td><td><button class=\"btn btn-link\">删除</button></td></tr>");
        });
        $.ajax(
                {
                    type: 'POST',
                      url: "/web/api/mongo/detail/get/?id="+decodeURIComponent(getUrlParameter("id")),
                      data: {},
                      success: function(data){
                              //console.log(data);
                              $("#cn_title").val(data.CN.title);
                              if(data.CN.desc!=undefined){
                                  $("#cn_desc_header").val(data.CN.desc.header);
                                  $("#cn_desc_description").val(data.CN.desc.description);
                              }
                              if(data.CN.genetic!=undefined) {
                                  $("#cn_genetic_header").val(data.CN.genetic.header);
                                  $("#cn_genetic_description").val(data.CN.genetic.description);
                              }
                              if(data.CN.ngenetic!=undefined) {
                                  $("#cn_ngenetic_header").val(data.CN.ngenetic.header);
                                  $("#cn_ngenetic_description").val(data.CN.ngenetic.description);
                              }
                              if(data.CN.clinical!=undefined) {
                                  $("#cn_clinical_header").val(data.CN.clinical.header);
                                  $("#cn_clinical_description").val(data.CN.clinical.description);
                              }
                              if(data.CN.diagnose!=undefined) {
                                  $("#cn_diagnose_header").val(data.CN.diagnose.header);
                                  $("#cn_diagnose_description").val(data.CN.diagnose.description);
                              }
                              if(data.CN.report!=undefined) {
                                  $("#cn_report_header").val(data.CN.report.header);
                                  $("#cn_report_0").val(data.CN.report.level0);
                                  $("#cn_report_1").val(data.CN.report.level1);
                                  $("#cn_report_2").val(data.CN.report.level2);
                                  $("#cn_report_3").val(data.CN.report.level3);
                                  $("#cn_report_4").val(data.CN.report.level4);
                              }
                              if(data.CN.suggestion!=undefined) {
                                  $("#cn_suggestion_header").val(data.CN.suggestion.header);
                                  $("#cn_suggestion_description").val(data.CN.suggestion.description);
                                  $("#cn_suggestion_descriptionM").val(data.CN.suggestion.descriptionM);
                                  $("#cn_suggestion_descriptionF").val(data.CN.suggestion.descriptionF);
                              }
                              if(data.CN.nutrition!=undefined) {
                                  $("#cn_nutrition_header").val(data.CN.nutrition.header);
                                  $("#cn_nutrition_description").val(data.CN.nutrition.description);
                                  $("#cn_nutrition_descriptionM").val(data.CN.nutrition.descriptionM);
                                  $("#cn_nutrition_descriptionF").val(data.CN.nutrition.descriptionF);

                                  $.each(data.CN.nutrition.compound,function(k,v){
                                      $("#cn_nutrition_table tbody").append("<tr><td><input type=\"text\" class=\"form-control\" value=\""+ v.name+"\"></td><td><input type=\"text\" class=\"form-control\" value=\""+ v.function+"\"></td><td><button class=\"btn btn-link\">删除</button></td></tr>");
                                  });
                              }
                                //console.log(data.CN.nutrition.compound)

                              if(data.CN.pic!=undefined) {
                                  $("#cn_pic").prop("src", "data:" + data.CN.pic.mimetype + ";base64," + data.CN.pic.base64);
                              }

                      }
                }
        );

    </script>
    <script>
        $("#en_data_id").val(decodeURIComponent(getUrlParameter("id")));
        $("#en_pic_form").ajaxForm();
        $("#en_submit").bind("click",function(e){
            if($("#en_choosefile").val().length>0){$("#en_pic_form").ajaxSubmit();}
            var para = {}
            para.EN={
                    title:$("#en_title").val(),
                    desc:{
                            header:$("#en_desc_header").val(),
                            description:$("#en_desc_description").val()
                            },
                    genetic:{
                            header:$("#en_genetic_header").val(),
                            description:$("#en_genetic_description").val()
                            },
                    ngenetic:{
                            header:$("#en_ngenetic_header").val(),
                            description:$("#en_ngenetic_description").val()
                            },
                    clinical:{
                            header:$("#en_clinical_header").val(),
                            description:$("#en_clinical_description").val()
                            },
                    diagnose:{
                            header:$("#en_diagnose_header").val(),
                            description:$("#en_diagnose_description").val()
                            },
                    report:{
                            header:$("#en_report_header").val(),
                            level0:$("#en_report_0").val(),
                            level1:$("#en_report_1").val(),
                            level2:$("#en_report_2").val(),
                            level3:$("#en_report_3").val(),
                            level4:$("#en_report_4").val()
                            },
                    suggestion:{
                            header:$("#en_suggestion_header").val(),
                            description:$("#en_suggestion_description").val(),
                            descriptionM:$("#en_suggestion_descriptionM").val(),
                            descriptionF:$("#en_suggestion_descriptionF").val()
                             },
                    nutrition:{
                            header:$("#en_nutrition_header").val(),
                            description:$("#en_nutrition_description").val(),
                            descriptionM:$("#en_nutrition_descriptionM").val(),
                            descriptionF:$("#en_nutrition_descriptionF").val()
                             }
                    }
            para._id=decodeURIComponent(getUrlParameter("id"))
            para.EN.nutrition.compound=[]
            var compound=$("#en_nutrition_table tbody").children();
            $.each(compound,function(k,v){
                para.EN.nutrition.compound[k]={
                                                    "name":compound[k].childNodes[0].childNodes[0].value,
                                                    "function":compound[k].childNodes[1].childNodes[0].value
                                                    }
            });
            $.ajax({
                type:"POST",
                contentType: "application/json; charset=utf-8",   //内容类型
                url:"/web/api/mongo/detail/post/",
                data:JSON.stringify(para),
                success:function(data){
                    alert("修改成功。");
                }

            })
        });
        $("#en_nutrition_table tbody").bind("click",function(e){
           if(e.target.innerText=="删除"){
               $(e.target.parentElement.parentElement).remove();
           }
        });
        $("#en_nutrition_btn").bind("click",function(e){
            $("#en_nutrition_table tbody").append("<tr><td><input type=\"text\" class=\"form-control\" ></td><td><input type=\"text\" class=\"form-control\" ></td><td><button class=\"btn btn-link\">删除</button></td></tr>");
        });
        $.ajax(
                {
                    type: 'POST',
                      url: "/web/api/mongo/detail/get/?id="+decodeURIComponent(getUrlParameter("id")),
                      data: {},
                      success: function(data){
                              //console.log(data);
                              $("#en_title").val(data.EN.title);
                              if(data.EN.desc!=undefined) {
                                  $("#en_desc_header").val(data.EN.desc.header);
                                  $("#en_desc_description").val(data.EN.desc.description);
                              }
                              if(data.EN.genetic!=undefined) {
                                  $("#en_genetic_header").val(data.EN.genetic.header);
                                  $("#en_genetic_description").val(data.EN.genetic.description);
                              }
                              if(data.EN.ngenetic!=undefined) {
                                  $("#en_ngenetic_header").val(data.EN.ngenetic.header);
                                  $("#en_ngenetic_description").val(data.EN.ngenetic.description);
                              }
                              if(data.EN.clinical!=undefined) {
                                  $("#en_clinical_header").val(data.EN.clinical.header);
                                  $("#en_clinical_description").val(data.EN.clinical.description);
                              }
                              if(data.EN.diagnose!=undefined) {
                                  $("#en_diagnose_header").val(data.EN.diagnose.header);
                                  $("#en_diagnose_description").val(data.EN.diagnose.description);
                              }
                              if(data.EN.report!=undefined) {
                                  $("#en_report_header").val(data.EN.report.header);
                                  $("#en_report_0").val(data.EN.report.level0);
                                  $("#en_report_1").val(data.EN.report.level1);
                                  $("#en_report_2").val(data.EN.report.level2);
                                  $("#en_report_3").val(data.EN.report.level3);
                                  $("#en_report_4").val(data.EN.report.level4);
                              }
                              if(data.EN.suggestion!=undefined) {
                                  $("#en_suggestion_header").val(data.EN.suggestion.header);
                                  $("#en_suggestion_description").val(data.EN.suggestion.description);
                                  $("#en_suggestion_descriptionM").val(data.EN.suggestion.descriptionM);
                                  $("#en_suggestion_descriptionF").val(data.EN.suggestion.descriptionF);
                              }
                              if(data.EN.nutrition!=undefined) {
                                  $("#en_nutrition_header").val(data.EN.nutrition.header);
                                  $("#en_nutrition_description").val(data.EN.nutrition.description);
                                  $("#en_nutrition_descriptionM").val(data.EN.nutrition.descriptionM);
                                  $("#en_nutrition_descriptionF").val(data.EN.nutrition.descriptionF);
                                  $.each(data.EN.nutrition.compound,function(k,v){
                                      $("#en_nutrition_table tbody").append("<tr><td><input type=\"text\" class=\"form-control\" value=\""+ v.name+"\"></td><td><input type=\"text\" class=\"form-control\" value=\""+ v.function+"\"></td><td><button class=\"btn btn-link\">删除</button></td></tr>");
                                  })
                              }
                                //console.log(data.EN.nutrition.compound)

                              if(data.EN.pic!=undefined) {
                                  $("#en_pic").prop("src", "data:" + data.EN.pic.mimetype + ";base64," + data.EN.pic.base64);
                              }

                      }
                }
        );

    </script>
  </body>
</html>